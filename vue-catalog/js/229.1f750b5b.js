"use strict";(self["webpackChunkvue_catalog"]=self["webpackChunkvue_catalog"]||[]).push([[229],{2620:function(e,t,o){o.r(t),o.d(t,{default:function(){return K}});var r=o(3396),s=o(7139);const n={key:0,class:"loader1"},i={key:1},l={key:0},a={key:1};function d(e,t,o,d,u,c){const p=(0,r.up)("login-form"),h=(0,r.up)("form-edit");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r._)("h1",null,(0,s.zw)(d.insert[d.lang].header),1),e.$store.state.appIsStarting?((0,r.wg)(),(0,r.iD)("div",n)):((0,r.wg)(),(0,r.iD)("div",i,[e.$store.state.isAuth?((0,r.wg)(),(0,r.iD)("div",a,[(0,r.Wm)(h,{insert:d.insert[d.lang]},null,8,["insert"])])):((0,r.wg)(),(0,r.iD)("div",l,[(0,r.Wm)(p)]))]))])}var u=o(5950),c=o(9242);const p={key:0,class:"loader1"},h={key:1},g={key:0},m=(0,r.Uk)(" ID: "),b=(0,r._)("br",null,null,-1),f=["innerHTML"],P={key:1},k=(0,r.Uk)(" ID: "),v={class:"form-group mb-10"},w=["placeholder","value"],y={class:"form-group mb-10"},$=["placeholder","value"],_={class:"form-group mb-20"},F=["value"],U=(0,r._)("hr",{class:"w540 hr-dashed"},null,-1),E={class:"form-group mb-10"},x=["placeholder"],N={class:"form-group mb-10"},B=["placeholder"];function T(e,t,o,n,i,l){const a=(0,r.up)("multi-upload");return e.$store.state.updProdFreeze?((0,r.wg)(),(0,r.iD)("div",p)):((0,r.wg)(),(0,r.iD)("div",h,[e.$store.state.updProd.brand&&e.$store.state.updProd.model?((0,r.wg)(),(0,r.iD)("div",P,[k,(0,r._)("b",null,(0,s.zw)(e.$route.params.id),1),(0,r._)("form",{onSubmit:t[6]||(t[6]=(0,c.iM)((()=>{}),["prevent"])),class:"mt-10"},[(0,r.Uk)((0,s.zw)(o.insert.brandLabel)+": ",1),(0,r._)("div",v,[(0,r._)("input",{class:(0,s.C_)(["form-control w540",{notfilled:i.isFilled1}]),placeholder:o.insert.brandPlaceholder,value:e.$store.state.updProd.brand,onInput:t[0]||(t[0]=(...e)=>l.inputBrand&&l.inputBrand(...e))},null,42,w)]),(0,r.Uk)(" "+(0,s.zw)(o.insert.modelLabel)+": ",1),(0,r._)("div",y,[(0,r._)("input",{class:(0,s.C_)(["form-control w540",{notfilled:i.isFilled2}]),placeholder:o.insert.modelPlaceholder,value:e.$store.state.updProd.model,onInput:t[1]||(t[1]=(...e)=>l.inputModel&&l.inputModel(...e))},null,42,$)]),(0,r.Uk)(" "+(0,s.zw)(o.insert.price)+": ",1),(0,r._)("div",_,[(0,r._)("input",{class:"form-control w100 text-center inline-block",placeholder:"",value:e.$store.state.updProd.price,onInput:t[2]||(t[2]=(...e)=>l.inputPrice&&l.inputPrice(...e))},null,40,F)]),(0,r.Wm)(a,{ref:"uplModule",uploadButton:o.insert.uploadButton,uploadedFiles:o.insert.uploadedFiles},null,8,["uploadButton","uploadedFiles"]),U,(0,r._)("h5",null,(0,s.zw)(o.insert.translationHeader)+":",1),(0,r.Uk)(" "+(0,s.zw)(o.insert.brand2Label)+": ",1),(0,r._)("div",E,[(0,r.wy)((0,r._)("input",{class:(0,s.C_)(["form-control w540"]),"onUpdate:modelValue":t[3]||(t[3]=t=>e.$store.state.updProd.brand2=t),placeholder:o.insert.brand2Placeholder},null,8,x),[[c.nr,e.$store.state.updProd.brand2]])]),(0,r.Uk)(" "+(0,s.zw)(o.insert.model2Label)+": ",1),(0,r._)("div",N,[(0,r.wy)((0,r._)("input",{class:(0,s.C_)(["form-control w540 mb-30"]),"onUpdate:modelValue":t[4]||(t[4]=t=>e.$store.state.updProd.model2=t),placeholder:o.insert.model2Placeholder},null,8,B),[[c.nr,e.$store.state.updProd.model2]])]),(0,r._)("button",{onClick:t[5]||(t[5]=(...e)=>l.checkForm&&l.checkForm(...e)),class:"btn2 greenBtn"},(0,s.zw)(o.insert.updButton),1)],32)])):((0,r.wg)(),(0,r.iD)("div",g,[m,(0,r._)("b",null,(0,s.zw)(e.$route.params.id),1),b,(0,r._)("div",{innerHTML:o.insert.notFound},null,8,f)]))]))}var D=o(8144),L=o(523),I=o(4143),M=o(1577),O=o(6265),S=o.n(O),z=o(6673),C=o(5041),R={en:{text1:"English version of Notification<br>Изменения сохранены<br>Создана запись на втором языке",saved:"English version of Notification<br>Изменения сохранены",text2:"English version of Notification<br>Изменения сохранены<br>Запись на втором языке удалена",text3:"English version of Notification<br>Изменения сохранены<br>Но возникла ошибка при внесении изменений на втором языке",text4:"English version of Notification<br>Изменения сохранены<br>Но возникла непредвиденная ошибка (подробности в консоли)",text5_1:"English version of Notification<br>Ошибка. Ответ сервера: ",text5_2:"<br>Подробности в консоли",errNetwork:"English version of Notification<br>Нет подключения к серверу"},uk:{text1:"Изменения сохранены<br>Создана запись на втором языке",saved:"Изменения сохранены",text2:"Изменения сохранены<br>Запись на втором языке удалена",text3:"Изменения сохранены<br>Но возникла ошибка при внесении изменений на втором языке",text4:"Изменения сохранены<br>Но возникла непредвиденная ошибка (подробности в консоли)",text5_1:"Ошибка. Ответ сервера: ",text5_2:"<br>Подробности в консоли",errNetwork:"Нет подключения к серверу"}},A=o(2276),Z={components:{MultiUpload:D.Z},mixins:[M.Z],props:{insert:{type:Object,required:!0}},data(){return{name:"FormEdit",isFilled1:!1,isFilled2:!1}},methods:{inputPrice(e){this.$store.commit("SetUpdPrice",this.checkPrice(e.target.value))},inputBrand(e){this.$store.commit("SetUpdBrand",e),0!==this.$store.state.updProd.brand.length?this.isFilled1=!1:this.isFilled1=!0},inputModel(e){this.$store.commit("SetUpdModel",e),0!==this.$store.state.updProd.model.length?this.isFilled2=!1:this.isFilled2=!0},checkForm(){0===this.$store.state.updProd.brand.length&&(this.isFilled1=!0),0===this.$store.state.updProd.model.length&&(this.isFilled2=!0),this.isFilled1||this.isFilled2||this.updateProduct()},async updateProduct(){console.log("\n\n@click ~~~~~~~~~~ updateProduct ~~~~~~~~~~ ");const e=S().create({withCredentials:!0});e.interceptors.request.use((e=>{console.log(">>>> customAxios - request (config)");let t=localStorage.getItem("AccessToken");return t&&(t=encodeURI(t)),e.headers.Authorization="Bearer "+t,e})),e.interceptors.response.use((e=>(console.log(">>>> customAxios - response (config)"),e)),(async t=>{console.log(">>>> customAxios - response (error)");const o=t.config;if(401==t.response.status&&t.config&&!t.config._isRetry&&(o._isRetry=!0,console.log("> 401 !!!!!!!!!!!: "),await this.tokenRefresh()))return console.log(" tokenRefresh TRUE!"),e.request(o);throw t}));const t=[...this.$store.getters.getPicsInDB,...this.$refs.uplModule.newPics];try{const o=await e.post(L.Ou.pathToAPI+"/products/update.php",JSON.stringify({id:this.$store.state.updProd.id,price:this.$store.state.updProd.price,pictures:t,language:this.$store.state.language,brand:this.$store.state.updProd.brand,model:this.$store.state.updProd.model,brand2:this.$store.state.updProd.brand2,model2:this.$store.state.updProd.model2}),{headers:{Accept:"application/json","Content-Type":"application/json"}});if(console.log("[3] response: ",o),"success"===o.data.status){switch(o.data.localeStatus){case"created":this.pushNotify(R[this.lang].text1,"notifyGreen");break;case"success":this.pushNotify(R[this.lang].saved,"notifyGreen");break;case"nothingToChanges":this.$store.commit("SetUpdProdTranslation",["",""]),this.pushNotify(R[this.lang].saved,"notifyGreen");break;case"deleted":this.$store.commit("SetUpdProdTranslation",["",""]),this.pushNotify(R[this.lang].text2,"notifyGreen");break;case"failed":this.pushNotify(R[this.lang].text3,"notifyOrange");break;default:this.pushNotify(R[this.lang].text4,"notifyOrange"),console.log(o);break}this.$refs.uplModule.delPicsToDelete(),this.getProducts("updateProduct()"),this.$refs.uplModule.hideBarAndClean(),this.$store.commit("UpdatePicsInDB",t)}else this.pushNotify(R[this.lang].text5_1+o.data.error+R[this.lang].text5_2,"notifyOrange"),console.log("Ошибка:"+o)}catch(o){if(!o.response)return;if("ERR_NETWORK"===o.code)return this.pushNotify(R[this.lang].errNetwork,"notifyOrange"),void console.log("Нет подключения к серверу");switch(o.response.data.status){case"expired":console.log("44 expired [E1] (BOTH TOKENS IS EXPIRED) ");break;case"failed":console.log(" failed [E2]");break;case"denied":console.log(" denied [E3]");break;case"approved":console.log(" 55 approved [E4] ");break;case"locked":console.log(" locked [E5] ");break;default:console.log("error [E6]: "+o);break}}}},mounted(){this.getUpdProd(this.$route.params.id,!0)},watch:{"$store.state.language":function(){console.log("["+this.name+"] -> language changes detected "),this.getUpdProd(this.$route.params.id,!0)}},setup(){const{tokenRefresh:e}=(0,I.Z)(),{lang:t}=(0,A.Z)("FormEdit"),{pushNotify:o}=(0,C.Z)(),{getProducts:r,getUpdProd:s,checkPrice:n}=(0,z.Z)();return{define:L.Ou,tokenRefresh:e,lang:t,pushNotify:o,getProducts:r,getUpdProd:s,checkPrice:n}}},H=o(89);const q=(0,H.Z)(Z,[["render",T]]);var G=q,V={en:{header:"Editing Auto",notFound:"Not found<br>Or no description in English<br>Try change language",brandLabel:"Brand",brandPlaceholder:"Type here brand",modelLabel:"Model",modelPlaceholder:"Type here model",price:"Price",uploadButton:"Upload Images",uploadedFiles:"Uploaded Files",translationHeader:"Translation into Ukrainian (not required)",brand2Label:"Brand",brand2Placeholder:"Type here the brand in Ukrainian",model2Label:"Model",model2Placeholder:"Type here the model in Ukrainian",updButton:"Save Changes"},uk:{header:"Редактирование авто",notFound:"Автотомобиль не найден.<br>Или отсутствует описание на украинском.<br>Попробуйте сменить язык.",brandLabel:"Марка",brandPlaceholder:"Напишите марку автомобиля",modelLabel:"Модель",modelPlaceholder:"Напишите модель",price:"Цена",uploadButton:"Загрузить",uploadedFiles:"Загружены файлы",translationHeader:"Перевод на английский (необязательно)",brand2Label:"Марка",brand2Placeholder:"Напишите марку на английском",model2Label:"Модель",model2Placeholder:"Напишите модель на английском",updButton:"Сохранить"}},W={components:{LoginForm:u.Z,FormEdit:G},data(){return{name:"EditView"}},setup(){const{lang:e}=(0,A.Z)("EditView");return{define:L.Ou,lang:e,insert:V}}};const j=(0,H.Z)(W,[["render",d]]);var K=j}}]);
//# sourceMappingURL=229.1f750b5b.js.map