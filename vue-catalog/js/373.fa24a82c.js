"use strict";(self["webpackChunkvue_catalog"]=self["webpackChunkvue_catalog"]||[]).push([[373],{9589:function(e,t,r){r.r(t),r.d(t,{default:function(){return V}});var o=r(3396),s=r(7139);const i={key:0,class:"loader1"},n={key:1},a={key:0},l={key:1};function d(e,t,r,d,u,c){const p=(0,o.up)("login-form"),h=(0,o.up)("form-edit");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("h1",null,(0,s.zw)(d.insert[d.lang].header),1),e.$store.state.appIsStarting?((0,o.wg)(),(0,o.iD)("div",i)):((0,o.wg)(),(0,o.iD)("div",n,[e.$store.state.isAuth?((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(h,{insert:d.insert[d.lang]},null,8,["insert"])])):((0,o.wg)(),(0,o.iD)("div",a,[(0,o.Wm)(p)]))]))])}var u=r(450),c=r(9242);const p={key:0,class:"loader1"},h={key:1},g={key:0},b=(0,o.Uk)(" ID: "),m=(0,o._)("br",null,null,-1),f=["innerHTML"],P={key:1},k=(0,o.Uk)(" ID: "),v={class:"form-group mb-10"},y=["placeholder","value"],w={class:"form-group mb-10"},$=["placeholder","value"],_={class:"form-group mb-20"},F=["value"],U=(0,o._)("hr",{class:"w540 hr-dashed"},null,-1),N={class:"form-group mb-10"},x=["placeholder"],E={class:"form-group mb-10"},B=["placeholder"];function T(e,t,r,i,n,a){const l=(0,o.up)("multi-upload");return e.$store.state.updProdFreeze?((0,o.wg)(),(0,o.iD)("div",p)):((0,o.wg)(),(0,o.iD)("div",h,[e.$store.state.updProd.brand&&e.$store.state.updProd.model?((0,o.wg)(),(0,o.iD)("div",P,[k,(0,o._)("b",null,(0,s.zw)(e.$route.params.id),1),(0,o._)("form",{onSubmit:t[6]||(t[6]=(0,c.iM)((()=>{}),["prevent"])),class:"mt-10"},[(0,o.Uk)((0,s.zw)(r.insert.brandLabel)+": ",1),(0,o._)("div",v,[(0,o._)("input",{class:(0,s.C_)(["form-control w540",{notfilled:n.isFilled1}]),placeholder:r.insert.brandPlaceholder,value:e.$store.state.updProd.brand,onInput:t[0]||(t[0]=(...e)=>a.inputBrand&&a.inputBrand(...e))},null,42,y)]),(0,o.Uk)(" "+(0,s.zw)(r.insert.modelLabel)+": ",1),(0,o._)("div",w,[(0,o._)("input",{class:(0,s.C_)(["form-control w540",{notfilled:n.isFilled2}]),placeholder:r.insert.modelPlaceholder,value:e.$store.state.updProd.model,onInput:t[1]||(t[1]=(...e)=>a.inputModel&&a.inputModel(...e))},null,42,$)]),(0,o.Uk)(" "+(0,s.zw)(r.insert.price)+": ",1),(0,o._)("div",_,[(0,o._)("input",{class:"form-control w100 text-center inline-block",placeholder:"",value:e.$store.state.updProd.price,onInput:t[2]||(t[2]=(...e)=>a.inputPrice&&a.inputPrice(...e))},null,40,F)]),(0,o.Wm)(l,{ref:"uplModule",uploadButton:r.insert.uploadButton,uploadedFiles:r.insert.uploadedFiles},null,8,["uploadButton","uploadedFiles"]),U,(0,o._)("h5",null,(0,s.zw)(r.insert.translationHeader)+":",1),(0,o.Uk)(" "+(0,s.zw)(r.insert.brand2Label)+": ",1),(0,o._)("div",N,[(0,o.wy)((0,o._)("input",{class:(0,s.C_)(["form-control w540"]),"onUpdate:modelValue":t[3]||(t[3]=t=>e.$store.state.updProd.brand2=t),placeholder:r.insert.brand2Placeholder},null,8,x),[[c.nr,e.$store.state.updProd.brand2]])]),(0,o.Uk)(" "+(0,s.zw)(r.insert.model2Label)+": ",1),(0,o._)("div",E,[(0,o.wy)((0,o._)("input",{class:(0,s.C_)(["form-control w540 mb-30"]),"onUpdate:modelValue":t[4]||(t[4]=t=>e.$store.state.updProd.model2=t),placeholder:r.insert.model2Placeholder},null,8,B),[[c.nr,e.$store.state.updProd.model2]])]),(0,o._)("button",{onClick:t[5]||(t[5]=(...e)=>a.checkForm&&a.checkForm(...e)),class:"btn2 greenBtn"},(0,s.zw)(r.insert.updButton),1)],32)])):((0,o.wg)(),(0,o.iD)("div",g,[b,(0,o._)("b",null,(0,s.zw)(e.$route.params.id),1),m,(0,o._)("div",{innerHTML:r.insert.notFound},null,8,f)]))]))}var D=r(297),L=r(523),I=r(4143),M=r(1577),S=r(6265),z=r.n(S),C=r(6673),O=r(5041),R={en:{text1:"English version of Notification<br>Изменения сохранены<br>Создана запись на втором языке",saved:"English version of Notification<br>Изменения сохранены",text2:"English version of Notification<br>Изменения сохранены<br>Запись на втором языке удалена",text3:"English version of Notification<br>Изменения сохранены<br>Но возникла ошибка при внесении изменений на втором языке",text4:"English version of Notification<br>Изменения сохранены<br>Но возникла непредвиденная ошибка (подробности в консоли)",text5_1:"English version of Notification<br>Ошибка. Ответ сервера: ",text5_2:"<br>Подробности в консоли",errNetwork:"English version of Notification<br>Нет подключения к серверу"},uk:{text1:"Изменения сохранены<br>Создана запись на втором языке",saved:"Изменения сохранены",text2:"Изменения сохранены<br>Запись на втором языке удалена",text3:"Изменения сохранены<br>Но возникла ошибка при внесении изменений на втором языке",text4:"Изменения сохранены<br>Но возникла непредвиденная ошибка (подробности в консоли)",text5_1:"Ошибка. Ответ сервера: ",text5_2:"<br>Подробности в консоли",errNetwork:"Нет подключения к серверу"}},Z=r(2276),A={components:{MultiUpload:D.Z},mixins:[M.Z],props:{insert:{type:Object,required:!0}},data(){return{isFilled1:!1,isFilled2:!1}},methods:{inputPrice(e){this.$store.commit("SetUpdPrice",this.checkPrice(e.target.value))},inputBrand(e){this.$store.commit("SetUpdBrand",e),0!==this.$store.state.updProd.brand.length?this.isFilled1=!1:this.isFilled1=!0},inputModel(e){this.$store.commit("SetUpdModel",e),0!==this.$store.state.updProd.model.length?this.isFilled2=!1:this.isFilled2=!0},checkForm(){0===this.$store.state.updProd.brand.length&&(this.isFilled1=!0),0===this.$store.state.updProd.model.length&&(this.isFilled2=!0),this.isFilled1||this.isFilled2||this.updateProduct()},async updateProduct(){const e=z().create({withCredentials:!0});e.interceptors.request.use((e=>{let t=localStorage.getItem("AccessToken");return t&&(t=encodeURI(t)),e.headers.Authorization="Bearer "+t,e})),e.interceptors.response.use((e=>e),(async t=>{const r=t.config;if(401==t.response.status&&t.config&&!t.config._isRetry&&(r._isRetry=!0,await this.tokenRefresh()))return e.request(r);throw t}));const t=[...this.$store.getters.getPicsInDB,...this.$refs.uplModule.newPics];try{const r=await e.post(L.Ou.pathToAPI+"/products/update.php",JSON.stringify({id:this.$store.state.updProd.id,price:this.$store.state.updProd.price,pictures:t,language:this.$store.state.language,brand:this.$store.state.updProd.brand,model:this.$store.state.updProd.model,brand2:this.$store.state.updProd.brand2,model2:this.$store.state.updProd.model2}),{headers:{Accept:"application/json","Content-Type":"application/json"}});if("success"===r.data.status){switch(r.data.localeStatus){case"created":this.pushNotify(R[this.lang].text1,"notifyGreen");break;case"success":this.pushNotify(R[this.lang].saved,"notifyGreen");break;case"nothingToChanges":this.$store.commit("SetUpdProdTranslation",["",""]),this.pushNotify(R[this.lang].saved,"notifyGreen");break;case"deleted":this.$store.commit("SetUpdProdTranslation",["",""]),this.pushNotify(R[this.lang].text2,"notifyGreen");break;case"failed":this.pushNotify(R[this.lang].text3,"notifyOrange");break;default:this.pushNotify(R[this.lang].text4,"notifyOrange"),console.log(r);break}this.$refs.uplModule.delPicsToDelete(),this.getProducts(),this.$refs.uplModule.hideBarAndClean(),this.$store.commit("UpdatePicsInDB",t)}else this.pushNotify(R[this.lang].text5_1+r.data.error+R[this.lang].text5_2,"notifyOrange")}catch(r){if(!r.response)return;if("ERR_NETWORK"===r.code)return void this.pushNotify(R[this.lang].errNetwork,"notifyOrange");switch(r.response.data.status){case"expired":console.log("44 expired [E1] (BOTH TOKENS IS EXPIRED) ");break;case"failed":console.log(" failed [E2]");break;case"denied":console.log(" denied [E3]");break;case"approved":console.log(" 55 approved [E4] ");break;case"locked":console.log(" locked [E5] ");break;default:console.log("error [E6]: "+r);break}}}},mounted(){this.getUpdProd(this.$route.params.id,!0)},watch:{"$store.state.language":function(){this.getUpdProd(this.$route.params.id,!0)}},setup(){const{tokenRefresh:e}=(0,I.Z)(),{lang:t}=(0,Z.Z)(),{pushNotify:r}=(0,O.Z)(),{getProducts:o,getUpdProd:s,checkPrice:i}=(0,C.Z)();return{define:L.Ou,tokenRefresh:e,lang:t,pushNotify:r,getProducts:o,getUpdProd:s,checkPrice:i}}},H=r(89);const q=(0,H.Z)(A,[["render",T]]);var G=q,W={en:{header:"Editing Auto",notFound:"Not found<br>Or no description in English<br>Try change language",brandLabel:"Brand",brandPlaceholder:"Type here brand",modelLabel:"Model",modelPlaceholder:"Type here model",price:"Price",uploadButton:"Upload Images",uploadedFiles:"Uploaded Files",translationHeader:"Translation into Ukrainian (not required)",brand2Label:"Brand",brand2Placeholder:"Type here the brand in Ukrainian",model2Label:"Model",model2Placeholder:"Type here the model in Ukrainian",updButton:"Save Changes"},uk:{header:"Редактирование авто",notFound:"Автотомобиль не найден.<br>Или отсутствует описание на украинском.<br>Попробуйте сменить язык.",brandLabel:"Марка",brandPlaceholder:"Напишите марку автомобиля",modelLabel:"Модель",modelPlaceholder:"Напишите модель",price:"Цена",uploadButton:"Загрузить",uploadedFiles:"Загружены файлы",translationHeader:"Перевод на английский (необязательно)",brand2Label:"Марка",brand2Placeholder:"Напишите марку на английском",model2Label:"Модель",model2Placeholder:"Напишите модель на английском",updButton:"Сохранить"}},j={components:{LoginForm:u.Z,FormEdit:G},setup(){const{lang:e}=(0,Z.Z)();return{lang:e,insert:W}}};const K=(0,H.Z)(j,[["render",d]]);var V=K}}]);
//# sourceMappingURL=373.fa24a82c.js.map