"use strict";(self["webpackChunkvue_catalog"]=self["webpackChunkvue_catalog"]||[]).push([[219],{219:function(e,t,i){i.r(t),i.d(t,{default:function(){return G}});var o=i(3396);const n={key:0},s={key:1};function l(e,t,i,l,r,a){const d=(0,o.up)("login-form"),c=(0,o.up)("prod-info");return(0,o.wg)(),(0,o.iD)("div",null,[e.$store.state.isAuth?((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(c)])):((0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(d)]))])}var r=i(2373),a=i(9242),d=i(7139);const c={key:0},u=["src"],g={key:1},p={key:0},h=(0,o._)("hr",null,null,-1),m={key:0},f=["src"],b=["src"],k={key:1},y=(0,o.Uk)(" ID: "),w=(0,o._)("br",null,null,-1),v=["innerHTML"];function _(e,t,i,n,s,l){const r=(0,o.up)("my-modal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(r,{visible:s.delModalVisible,"onUpdate:visible":t[0]||(t[0]=e=>s.delModalVisible=e),header:n.insert[n.lang].myModal.header,message:s.modalText,btn1Text:n.insert[n.lang].myModal.btn1Text,btn2Text:n.insert[n.lang].myModal.btn2Text,onConfirmed:l.deleteProduct,modalColors:"modalOrange",pic:"alert"},null,8,["visible","header","message","btn1Text","btn2Text","onConfirmed"]),e.$store.state.isProdsLoading?((0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("img",{src:n.define.pathToGraphics+"/loaders/loader_1_32px.gif",alt:""},null,8,u)])):((0,o.wg)(),(0,o.iD)("div",g,[s.item.id?((0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("button",{class:"btn btn-success mr-6 min-80",onClick:t[1]||(t[1]=(0,a.iM)((t=>e.$router.push("/edit/"+s.item.id)),["stop"]))},(0,d.zw)(n.insert[n.lang].editBtn),1),(0,o._)("button",{class:"btn btn-warning min-80",onClick:t[2]||(t[2]=(0,a.iM)((e=>l.confirmDelete(s.item.id,s.item.model)),["stop"]))},(0,d.zw)(n.insert[n.lang].deleteBtn),1),h,(0,o._)("h1",null,(0,d.zw)(s.item.brand),1),(0,o._)("h2",null,(0,d.zw)(s.item.model),1),(0,o._)("p",null,(0,d.zw)(n.insert[n.lang].price)+": "+(0,d.zw)(s.item.price)+" USD",1),s.item.pictures?((0,o.wg)(),(0,o.iD)("div",m,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.item.pictures,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:e},[0===t?((0,o.wg)(),(0,o.iD)("img",{key:0,src:n.define.pathToUploads+"/"+e,class:"img-fluid",alt:""},null,8,f)):(0,o.kq)("",!0)])))),128))])):((0,o.wg)(),(0,o.iD)("img",{key:1,src:n.define.pathToGraphics+"/default2_190px.png",alt:""},null,8,b))])):((0,o.wg)(),(0,o.iD)("div",k,[y,(0,o._)("b",null,(0,d.zw)(e.$route.params.id),1),w,(0,o._)("div",{innerHTML:n.insert[n.lang].empty},null,8,v)]))]))],64)}var T=i(523),D=i(4143);const x={key:0,class:"dialog-bg"},C={className:"modal_flex"},M=["src"],B=["innerHTML"],E={class:"btns"};function N(e,t,i,n,s,l){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(a.uT,{name:"fade"},{default:(0,o.w5)((()=>[i.visible?((0,o.wg)(),(0,o.iD)("div",x)):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(a.uT,{name:"slide-fade"},{default:(0,o.w5)((()=>[i.visible?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"dialog-wrapper",onClick:t[3]||(t[3]=(...e)=>l.hideModal&&l.hideModal(...e))},[i.visible?((0,o.wg)(),(0,o.iD)("div",{key:0,onClick:t[2]||(t[2]=(0,a.iM)((()=>{}),["stop"])),class:"dialog__content"},[(0,o._)("div",{class:(0,d.C_)(["header",i.modalColors])},(0,d.zw)(i.header),3),(0,o._)("div",C,[s.picture?((0,o.wg)(),(0,o.iD)("img",{key:0,src:n.define.pathToGraphics+s.picture,alt:""},null,8,M)):(0,o.kq)("",!0),(0,o._)("div",{class:"message",innerHTML:i.message},null,8,B)]),(0,o._)("div",E,[(0,o._)("button",{class:(0,d.C_)(["btn2",s.btn1Color]),onClick:t[0]||(t[0]=(...e)=>l.confirmClick&&l.confirmClick(...e))},(0,d.zw)(i.btn1Text),3),(0,o._)("button",{class:(0,d.C_)(["btn2",s.btn2Color]),onClick:t[1]||(t[1]=(...e)=>l.hideModal&&l.hideModal(...e))},(0,d.zw)(i.btn2Text),3)])])):(0,o.kq)("",!0)])):(0,o.kq)("",!0)])),_:1})],64)}var P={props:{header:{type:String,default:"Модальное окно"},message:{type:String,default:"Текст модального окна"},btn1Text:{type:String,default:"Ок"},btn2Text:{type:String,default:"Отмена"},visible:{type:Boolean,default:!1},modalColors:{type:String,default:""},pic:{type:String,default:""}},data(){return{picture:"",btn1Color:"blueBtn",btn2Color:"blueBtn"}},emits:["update:visible","confirmed"],methods:{hideModal(){this.$emit("update:visible",!1)},confirmClick(){this.$emit("confirmed")},setModalStyle(){switch(this.pic){case"alert":this.picture="/alert_48px.png",this.btn1Color="orangeBtn",this.btn2Color="orangeBtn";break;case"info":this.picture="/info_48px.png",this.btn1Color="blueBtn",this.btn2Color="blueBtn";break;default:this.picture="",this.btn1Color="greenBtn",this.btn2Color="greenBtn";break}}},mounted(){this.setModalStyle()},setup(){return{define:T.Ou}}},$=i(89);const S=(0,$.Z)(P,[["render",N],["__scopeId","data-v-ccafba5c"]]);var O=S,R=i(6265),q=i.n(R),z=i(6673),I={en:{myModal:{header:"Deleting",btn1Text:"Yes",btn2Text:"No",question:"Delete "},editBtn:"Edit",deleteBtn:"Delete",price:"Price",empty:"Not found<br>Or no description in English<br>Try change language"},uk:{myModal:{header:"Удаление",btn1Text:"Да",btn2Text:"Нет",question:"Удалить "},editBtn:"Редактировать",deleteBtn:"Удалить",price:"Цена",empty:"Не найдено<br>Или отсутствует описание на украинском<br>Попробуйте сменить язык"}},U=i(5041),A={en:{errNetwork:"English version of Notification<br>Нет подключения к серверу",deleted:"English version of Notification<br>Удаление выполнено",text5_1:"English version of Notification<br>Ошибка. Ответ сервера: ",text5_2:"<br>Подробности в консоли"},uk:{errNetwork:"Нет подключения к серверу",deleted:"Удаление выполнено",text5_1:"Ошибка. Ответ сервера: ",text5_2:"<br>Подробности в консоли"}},H=i(2276),Z={components:{MyModal:O},data(){return{name:"ProdInfo",item:"",idToDelete:0,modalText:"",delModalVisible:!1}},methods:{getItem(){this.item=this.$store.state.products.find((e=>e.id==this.$route.params.id))},confirmDelete(e,t){this.idToDelete=e,this.modalText=this.insert[this.lang].myModal.question+" <b>"+t+"</b>?",this.delModalVisible=!0,console.log("-> confirmDelete() id:"+e)},async deleteProduct(){console.log("\n\n@click ~~~~~~~~~~ deleteProduct ~~~~~~~~~~ ");const e=q().create({withCredentials:!0});e.interceptors.request.use((e=>{console.log(">>>> customAxios - request (config)");let t=localStorage.getItem("AccessToken");return t&&(t=encodeURI(t)),e.headers.Authorization="Bearer "+t,e})),e.interceptors.response.use((e=>(console.log(">>>> customAxios - response (config)"),e)),(async t=>{console.log(">>>> customAxios - response (error)");const i=t.config;if(401==t.response.status&&t.config&&!t.config._isRetry&&(i._isRetry=!0,console.log("> 401 !!!!!!!!!!!: "),await this.tokenRefresh()))return console.log(" tokenRefresh TRUE!"),e.request(i);throw t}));try{const t=await e.post(T.Ou.pathToAPI+"/products/delete.php",JSON.stringify({id:this.idToDelete}),{headers:{Accept:"application/json","Content-Type":"application/json"}});if(console.log("[3] response: ",t),"success"===t.data.status){console.log("deleteData() id:"+this.idToDelete);const e=this.$store.state.products.filter((e=>e.id!==this.idToDelete));this.$store.commit("SetProducts",e),this.pushNotify(A[this.lang].deleted,"notifyOrange"),this.delModalVisible=!1,this.$router.push("/")}else this.pushNotify(A[this.lang].text5_1+t.data.error+A[this.lang].text5_2,"notifyOrange"),console.log("Ошибка:"+t)}catch(t){if(console.log("e: ",t),"ERR_NETWORK"===t.code)return this.pushNotify(A[this.lang].errNetwork,"notifyOrange"),void console.log("Нет подключения к серверу");switch(t.response.data.status){case"expired":console.log(" expired [E1] (BOTH TOKENS IS EXPIRED) ");break;case"failed":console.log(" failed [E2]");break;case"denied":console.log(" denied [E3]");break;case"approved":console.log(" approved [E4] ");break;case"locked":console.log(" locked [E5] ");break;default:console.log("error [E6]: "+t);break}}}},mounted(){this.getUpdProd(this.$route.params.id),this.item=this.$store.state.updProd},watch:{"$store.state.language":function(){console.log("[ProdInfo] -> language changes detected "),this.getUpdProd(this.$route.params.id),this.item=this.$store.state.updProd}},setup(){const{tokenRefresh:e}=(0,D.Z)(),{lang:t}=(0,H.Z)(),{pushNotify:i}=(0,U.Z)(),{deleteData:o,getUpdProd:n}=(0,z.Z)();return{define:T.Ou,tokenRefresh:e,lang:t,insert:I,pushNotify:i,deleteData:o,getUpdProd:n}}};const L=(0,$.Z)(Z,[["render",_]]);var W=L,V={components:{LoginForm:r.Z,ProdInfo:W}};const Y=(0,$.Z)(V,[["render",l]]);var G=Y}}]);
//# sourceMappingURL=219.9adf9399.js.map