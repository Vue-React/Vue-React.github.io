(function(){"use strict";var t={523:function(t,e,o){o.d(e,{Cf:function(){return a},Ou:function(){return n},re:function(){return i}});const n={host:"",pathToGraphics:"",pathToAPI:""};"localhost"===location.hostname?(n.host="http://localhost:8080",n.pathToAPI="https://jwt/api",n.pathToGraphics="https://jwt/_graphics(copy)"):(n.host="https://massaclub.com",n.pathToAPI="https://massaclub.com/jwt/api",n.pathToGraphics="https://massaclub.com/jwt/_graphics(copy)");n.pathToAPI,n.pathToAPI;const a=14e3,i=15e3;n.pathToGraphics},4601:function(t,e,o){o.d(e,{Z:function(){return l}});var n=o(4870),a=o(65),i=o(6265),r=o.n(i),s=o(523),c=o(5041);function l(){const t=(0,a.oR)(),{pushNotify:e}=(0,c.Z)(),o=(0,n.iH)("vasya2@coder.com"),i=(0,n.iH)("888"),l=(0,n.iH)(localStorage.getItem("AccessToken"));async function u(){try{const n=await r().post(s.Ou.pathToAPI+"/login.php",JSON.stringify({email:o.value,password:i.value}),{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});console.log("response: ",n),console.log("response.data: ",n.data),console.log("-----"),"approved"===n.data.status&&n.data.accessToken&&n.data.name?(localStorage.setItem("AccessToken",n.data.accessToken),localStorage.setItem("name",n.data.name),r().defaults.headers.common.Authorization="Bearer "+n.data.accessToken,e("Добро пожаловать!<br>Вам открыт доступ к приложению","notifyWelcome",s.re),t.commit("SetIsAuth",!0)):e("Ошибка. Сервер вернул некорректный ответ","notifyOrange")}catch(n){if("ERR_NETWORK"===n.code)return e("Нет подключения к серверу","notifyOrange"),void console.log("Нет подключения к серверу");switch(n.response.data.status){case"expired":p();break;case"denied":e("Доступ закрыт<br>Проверьте логин и пароль","notifyOrange");break;default:e("Ошибка. Подробности в консоли","notifyOrange"),console.log(n);break}}}async function d(){try{const o=await r().post(s.Ou.pathToAPI+"/logout.php",JSON.stringify({message:"Привет сервер! С этим сообщением ты сможешь прочитать cookie"}),{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});console.log("response: ",o),console.log("-----"),"ok"===o.data.status?(delete r().defaults.headers.common.Authorization,t.commit("SetIsAuth",!1),localStorage.removeItem("AccessToken"),localStorage.removeItem("name"),e("Вы вышли из приложения","notifyWelcome",s.re)):(e("Ошибка. Ответ сервера: "+o.data.error+"<br>Подробности в консоли","notifyOrange"),console.log(o))}catch(o){if("ERR_NETWORK"===o.code)return e("Нет подключения к серверу","notifyOrange"),void console.log("Нет подключения к серверу")}}async function f(){if(l.value){r().defaults.headers.common.Authorization="Bearer "+l.value;try{const o=await r().post(s.Ou.pathToAPI+"/validate_token.php",{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});console.log("response: ",o),console.log("response.data: ",o.data),console.log("-----"),"allowed"===o.data.status?(e("У вас есть доступ к приложению","notifyWelcome",s.re),t.commit("SetIsAuth",!0)):(e("Ошибка. Ответ сервера: "+o.data.error+"<br>Подробности в консоли","notifyOrange"),console.log(o))}catch(o){if("ERR_NETWORK"===o.code)return e("Нет подключения к серверу","notifyOrange"),void console.log("Нет подключения к серверу");switch(o.response.data.status){case"expired":p();break;case"failed":e("Alarm! Передан некорректный токен.<br>Доступ закрыт","notifyRed");break;case"denied":e("Alarm! Передан пустой токен.<br>Доступ закрыт","notifyRed");break;default:e("Ошибка. Подробности в консоли","notifyOrange"),console.log(o);break}}}}async function p(){console.log("\ntokenRefresh!\n-------------");try{const o=await r().post(s.Ou.pathToAPI+"/refresh_token.php",JSON.stringify({message:"Привет сервер! С этим сообщением ты сможешь прочитать cookie"}),{withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}});console.log("response: ",o),console.log("response.data: ",o.data),console.log("response.data.status: ",o.data.status),console.log("-----"),"approved"===o.data.status&&o.data.accessToken?(e("Access Token обновлен<br>У вас есть доступ к приложению","notifyWelcome",s.re),t.commit("SetIsAuth",!0),localStorage.setItem("AccessToken",o.data.accessToken),r().defaults.headers.common.Authorization="Bearer "+o.data.accessToken):(e("Ошибка. Ответ сервера: "+o.data.error+"<br>Подробности в консоли","notifyOrange"),console.log(o))}catch(o){if("ERR_NETWORK"===o.code)return e("Нет подключения к серверу","notifyOrange"),void console.log("Нет подключения к серверу");switch(o.response.data.status){case"expired":e("Залогиньтесь","notifyBlue"),console.log(o);break;case"failed":e("Alarm! Передан некорректный токен.<br>Доступ закрыт","notifyRed"),console.log(o);break;case"denied":e("Залогиньтесь","notifyBlue"),console.log(o);break;default:e("Ошибка. Подробности в консоли","notifyOrange"),console.log(o);break}}}return{email:o,password:i,login:u,logout:d,validateToken:f}}},5041:function(t,e,o){o.d(e,{Z:function(){return i}});var n=o(65),a=o(523);function i(){const t=(0,n.oR)();function e(e){t.commit("DelNotify",e)}function o(e="Default Notification Text",o="notifyBlue",n=a.Cf){let i=Date.now(),r={id:i,notifyText:e,class:o};t.commit("AddNotify",r),setTimeout((()=>{t.commit("DelNotify",i)}),n)}return{delNotify:e,pushNotify:o}}},8504:function(t,e,o){var n=o(9242),a=o(3396);function i(t,e,o,n,i,r){const s=(0,a.up)("NotifyList"),c=(0,a.up)("nav-bar"),l=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(s),(0,a.Wm)(c),(0,a.Wm)(l,{class:"container view"})],64)}const r={class:"bg-dark"},s={class:"navbar navbar-dark justify-content-between container"},c={class:"nav nav-pills"},l={class:"nav-item"},u=(0,a.Uk)("Каталог"),d={class:"nav-item"},f=(0,a.Uk)("+ Добавить авто"),p={key:0},m={class:"nav-item"},h=(0,a.Uk)("Войти"),g={key:1},v={class:"nav-item"},y={class:"nav nav-pills"},b={class:"nav-item"},k=(0,a.Uk)("О сайте");function w(t,e,o,n,i,w){const T=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("nav",s,[(0,a._)("ul",c,[(0,a._)("li",l,[(0,a.Wm)(T,{to:"/",class:"nav-link"},{default:(0,a.w5)((()=>[u])),_:1})]),(0,a._)("li",d,[(0,a.Wm)(T,{to:"/add",class:"nav-link"},{default:(0,a.w5)((()=>[f])),_:1})]),t.$store.state.isAuth?((0,a.wg)(),(0,a.iD)("span",g,[(0,a._)("li",v,[(0,a._)("div",{class:"nav-link",onClick:e[0]||(e[0]=(...t)=>n.logout&&n.logout(...t))},"Выйти")])])):((0,a.wg)(),(0,a.iD)("span",p,[(0,a._)("li",m,[(0,a.Wm)(T,{to:"/login",class:"nav-link"},{default:(0,a.w5)((()=>[h])),_:1})])]))]),(0,a._)("ul",y,[(0,a._)("li",b,[(0,a.Wm)(T,{to:"/about",class:"nav-link"},{default:(0,a.w5)((()=>[k])),_:1})])])])])}var T=o(4601),_={methods:{},setup(){const{logout:t}=(0,T.Z)();return{logout:t}}},A=o(89);const O=(0,A.Z)(_,[["render",w]]);var N=O,j=o(7139);const I=["innerHTML"],C=["onClick"],S=["src"];function P(t,e,o,i,r,s){return(0,a.wg)(),(0,a.j4)(n.W3,{name:"notify",tag:"div",className:"notifyArea"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.$store.state.notifyList,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:(0,j.C_)(["notifyItem",t.class])},[(0,a._)("div",{className:"notifyText",innerHTML:t.notifyText},null,8,I),(0,a._)("span",{className:"delNotifyBtn",onClick:e=>i.delNotify(t.id)},[(0,a._)("img",{src:r.define.pathToGraphics+"/delete4_14px.png",alt:""},null,8,S)],8,C)],2)))),128))])),_:1})}var R=o(523),W=o(5041),x={data(){return{define:R.Ou}},setup(){const{delNotify:t}=(0,W.Z)();return{delNotify:t}}};const E=(0,A.Z)(x,[["render",P]]);var D=E,L={components:{NavBar:N,NotifyList:D},beforeCreate(){this.validateToken()},setup(){const{validateToken:t}=(0,T.Z)();return{validateToken:t}}};const Z=(0,A.Z)(L,[["render",i]]);var B=Z,H=o(2483);const U={class:"home"},M=(0,a._)("h1",null,"Каталог",-1),G={key:0},K={key:1},$=(0,a.Uk)(" Карточки с автомобилями, пагинацию + сортировку по цене и названию."),z=(0,a._)("br",null,null,-1),F=(0,a.Uk)(" Карточки содержит марку, модель, изображение, цену "),q=[$,z,F];function J(t,e,o,n,i,r){const s=(0,a.up)("login-form");return(0,a.wg)(),(0,a.iD)("div",U,[M,t.$store.state.isAuth?((0,a.wg)(),(0,a.iD)("div",K,q)):((0,a.wg)(),(0,a.iD)("div",G,[(0,a.Wm)(s)]))])}var Y=o(815),V={components:{LoginForm:Y.Z},methods:{async login(){await this.$store.commit("Login"),this.$router.push("/")}}};const Q=(0,A.Z)(V,[["render",J]]);var X=Q;const tt=[{path:"/",component:X},{path:"/:id",component:()=>o.e(36).then(o.bind(o,4036))},{path:"/add",component:()=>o.e(767).then(o.bind(o,1767))},{path:"/login",component:()=>o.e(281).then(o.bind(o,6281))},{path:"/about",component:()=>o.e(823).then(o.bind(o,5823))}],et=(0,H.p7)({history:(0,H.PO)("/vue-auto/"),base:"/vue-auto/",routes:tt});var ot=et,nt=o(65),at=(0,nt.MT)({state(){return{isAuth:!1,notifyList:[]}},mutations:{SetIsAuth(t,e){t.isAuth=e},DelNotify(t,e){t.notifyList=t.notifyList.filter((t=>t.id!==e))},AddNotify(t,e){t.notifyList=[e,...t.notifyList]}}});(0,n.ri)(B).use(at).use(ot).mount("#app")},815:function(t,e,o){o.d(e,{Z:function(){return v}});var n=o(3396),a=o(9242);const i=(0,n._)("p",null,"Доступ ограничен. Авторизуйтесь.",-1),r={class:"loginForm"},s={class:"mb-3"},c=(0,n._)("label",{for:"exampleInputEmail1",class:"form-label"},"Логин (email)",-1),l={class:"mb-3"},u=(0,n._)("label",{for:"exampleInputPassword1",class:"form-label"},"Пароль",-1),d=(0,n._)("button",{type:"submit",class:"btn btn-primary"},"Войти",-1);function f(t,e,o,f,p,m){return(0,n.wg)(),(0,n.iD)(n.HY,null,[i,(0,n._)("div",r,[(0,n._)("form",{onSubmit:e[2]||(e[2]=(0,a.iM)(((...t)=>f.login&&f.login(...t)),["prevent"]))},[(0,n._)("div",s,[c,(0,n.wy)((0,n._)("input",{type:"email","onUpdate:modelValue":e[0]||(e[0]=t=>f.email=t),class:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",required:""},null,512),[[a.nr,f.email]])]),(0,n._)("div",l,[u,(0,n.wy)((0,n._)("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>f.password=t),class:"form-control",id:"exampleInputPassword1",required:""},null,512),[[a.nr,f.password]])]),d],32)])],64)}var p=o(4601),m={data(){return{}},methods:{},setup(){const{email:t,password:e,login:o}=(0,p.Z)();return{email:t,password:e,login:o}}},h=o(89);const g=(0,h.Z)(m,[["render",f]]);var v=g}},e={};function o(n){var a=e[n];if(void 0!==a)return a.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}o.m=t,function(){var t=[];o.O=function(e,n,a,i){if(!n){var r=1/0;for(u=0;u<t.length;u++){n=t[u][0],a=t[u][1],i=t[u][2];for(var s=!0,c=0;c<n.length;c++)(!1&i||r>=i)&&Object.keys(o.O).every((function(t){return o.O[t](n[c])}))?n.splice(c--,1):(s=!1,i<r&&(r=i));if(s){t.splice(u--,1);var l=a();void 0!==l&&(e=l)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[n,a,i]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.f={},o.e=function(t){return Promise.all(Object.keys(o.f).reduce((function(e,n){return o.f[n](t,e),e}),[]))}}(),function(){o.u=function(t){return"js/"+t+"."+{36:"6a0201f9",281:"5e05132c",767:"88591911",823:"7cfb8f58"}[t]+".js"}}(),function(){o.miniCssF=function(t){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="vue-auto:";o.l=function(n,a,i,r){if(t[n])t[n].push(a);else{var s,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==e+i){s=d;break}}s||(c=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",e+i),s.src=n),t[n]=[a];var f=function(e,o){s.onerror=s.onload=null,clearTimeout(p);var a=t[n];if(delete t[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(t){return t(o)})),e)return e(o)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.p="/vue-auto/"}(),function(){var t={143:0};o.f.j=function(e,n){var a=o.o(t,e)?t[e]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((function(o,n){a=t[e]=[o,n]}));n.push(a[2]=i);var r=o.p+o.u(e),s=new Error,c=function(n){if(o.o(t,e)&&(a=t[e],0!==a&&(t[e]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",s.name="ChunkLoadError",s.type=i,s.request=r,a[1](s)}};o.l(r,c,"chunk-"+e,e)}},o.O.j=function(e){return 0===t[e]};var e=function(e,n){var a,i,r=n[0],s=n[1],c=n[2],l=0;if(r.some((function(e){return 0!==t[e]}))){for(a in s)o.o(s,a)&&(o.m[a]=s[a]);if(c)var u=c(o)}for(e&&e(n);l<r.length;l++)i=r[l],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(u)},n=self["webpackChunkvue_auto"]=self["webpackChunkvue_auto"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(8504)}));n=o.O(n)})();
//# sourceMappingURL=app.50f3783c.js.map